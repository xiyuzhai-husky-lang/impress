% !TEX options=--shell-escape
\documentclass{article}

\usepackage{arxiv}

\usepackage{amsmath}
\usepackage{amstext}
\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{cleveref}       % smart cross-referencing
\usepackage{lipsum}         % Can be removed after putting your text content
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{doi}
\usepackage{minted}
\usepackage{tcolorbox}
\usepackage{xcolor}

\title{The Husky Programming Language}

\date{}


\author{Xiyu Zhai}
\renewcommand{\headeright}{Technical Report}
\renewcommand{\undertitle}{Technical Report}
\renewcommand{\shorttitle}{\textit{arXiv} Template}

%%% Add PDF metadata to help others organize their library
%%% Once the PDF is generated, you can check the metadata with
%%% $ pdfinfo template.pdf
\hypersetup{
pdftitle={A template for the arxiv style},
pdfsubject={q-bio.NC, q-bio.QM},
pdfauthor={David S.~Hippocampus, Elias D.~Striatum},
pdfkeywords={First keyword, Second keyword, More},
}




\begin{document}

\usemintedstyle{xcode}
% \definecolor{codeBg}{HTML}{282822}
% \definecolor{textBg}{HTML}{1c1c17}

% \pagecolor{textBg}
% \color{white}
\maketitle

\begin{abstract}
	The Husky programming language is new programming language designed for next-generation AI and software.
\end{abstract}


% keywords can be removed
\keywords{First keyword \and Second keyword \and More}

\setminted[python]{
	breaklines=true,
	encoding=utf8,
	fontsize=\footnotesize,
	tabsize=4,
	bgcolor=codeBg
}


\section{Introduction}
This is introduction.

Rust~\cite{bugden2022rust}.

\section{Super Computation Graph}

\paragraph{Super computation graph in the simplest form.} Let $G$ be a directed graph with vertices $V$. We associate each vertex $v\in V$ with a type $T_v$.

Let $V^{\text{sources}}$ be all the source vertices and let $T^{\text{source}}:=\prod_{v\in V^{\text{sources}}}T_v$ be the product of all the types associated with source vertices.

Let $V^{\text{incoming}}_v$ be all the incoming vertices of some non-source vertex $v\in V$, and let $T^{\text{incoming}}_v:=\prod_{v\in V^{\text{incoming}}_v}T_v$ be the product of all the types associated with incoming vertices of $v$.

Given assigments of generators $g_v$ for each non-source $v\in V\setminus V^{\text{source}}$ a function of type to be specified later, we aim to construct $f_v: T^{\text{source}} \rightarrow T_v$ for each $v\in V$, as follows,

\begin{itemize}
	\item First, we specify that for each source vertex $v\in V^{\text{source}}$, $f_v$ is the projection from $T^{\text{source}}$ to $T_v$.
	\item Then, we specify that for each non-source vertex $v\in V\setminus V^{\text{source}}$,
	      \begin{equation}
		      f_v:=g_v(f^{\text{incoming}}_v)\circ f^{\text{incoming}}_v
	      \end{equation}
	      where
	      \begin{equation}
		      f^{\text{incoming}}_v:=\prod_{v'\in V^{\text{incoming}}_v}f_{v'}.
	      \end{equation}
\end{itemize}

The type of $g_v$ is thus determined to be $\prod_{v'\in V^{\text{incoming}}_{v}}(T^{\text{source}} \rightarrow T_{v'})\rightarrow T^{\text{incoming}}_v\rightarrow T_v$.

The key takeaway is that we don't specify $f_v$ by simply composing those $f_{v'}$ with $v'$ incoming vertices of $v$ with a fixed function, we specify by generating a function based on incoming vertices and then compose. By setting $g_v$ to be a constant function over the first argument, we recover the ordinary computation graph.

The following C code implements.
\begin{minted}[tabsize=4]{C}
int x = 0;

int y() { return x + 1; }

int y_with_x(int new_x) {
	int old_x = new_x;
	x = new_x;
	int y_value = y();
	x = old_x;
	return y_value;
}

int main() {
	printf("y equals %d\n", y());
	printf("y with x = 2 equals %d\n", y_with_x(2));
	printf("y equals %d\n", y());
}
\end{minted}
\bibliographystyle{unsrtnat}
\bibliography{references}  %%% Uncomment this line and comment out the ``thebibliography'' section below to use the external .bib file (using bibtex) .
\end{document}